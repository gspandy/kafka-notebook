# 2. kafka文件存储机制


![](../assets/kafka文件存储机制.png)

* 由于生产者生产的消息会不断追加到 log 文件末尾，为防止 log文件过大导致数据定位效率低下，kafka采取了 **分片** 和 **索引**机制，将每个 partition 分为多个 segment。
* 每个segment 对应2个文件: .log 和 .index，这些文件位于1个文件夹下，该文件命名规则为: **topic名称+分区区号**
    * index 和 log文件以当前的 segment的第1条消息的offset命名。

如，mytopic 这个 topic有3个分区，则其对应的文件的文件夹为 mytopic-0、mytopic-1、mytopic-2

```
00000000000000000000.index
00000000000000000000.log
00000000000000017041.index
00000000000000017041.log
000000000000000239430.index
000000000000000239430.log
```